# HTTP报文

## 报文流

HTTP报文是在HTTP应用程序之间发送的数据块。这些数据块以一些文本形式的源信息(meta-infomation)开头，这些信息描述了报文的内容及含义，垢面跟着可选的数据部分。这些报文在客户端、服务器和代理之间流动。属于“流入”、“流出”、“上游”、“下游”都是来描述报文方向的。

* 报文流入源端服务器，工作完成后，会流回用户的Agent代理中
* HTTP报文回想河水一样流动。不管是请求报文还是响应报文，艘油报文都会向下游流动。所有报文的发送者都在接收者的上游。

## 报文的组成部分

HTTP报文是简单的格式化数据块。每条报文都包含一套来自客户端的请求，或者一条来自服务器的响应。它们有三部分组成：起始行、首部块、数据主体。

起始行和首部就是由行分隔的ASCII文本。每行都以一个由两个字符组成的行终止序列(回车符(ASCII：13)+换行符(ASCII：10))为结束。这个行终止序列可以写做CRLF。

实体的主体或报文的主体是一个可选的数据块。主体中可以包含文本或二进制，也可以为空。


### 报文语法

>请求报文的格式
>><method\> <request-URL\> <version\>
>
>><headers\>
>
>><entity-body\>

>响应报文的格式
>
>><version\> <status\> <reason-phrase\>
>>
>><headers\>
>>
>><entity-body\>

### 起始行

* **请求行** 
* **响应行**
* **方法**

>GET
>>
>从服务器获取一份文档
>>
>是否包含主体:否

>HEAD
>>
>只从服务器获取文档的首部
>>
>是否包含主体:否

>POST
>>
>向服务器发送需要处理的数据
>>
>是否包含主体:是

>PUT
>>
>将请求的主题部分存储在服务器上
>>
>是否包含主体:是

>TRACE
>>
>对可能经过代理服务器传送到服务器上去的报文进行追踪
>>
>是否包含主体:否

>OPTION
>>
>决定可以在服务器上执行那些方法
>>
>是否包含主体:否

>DELETE
>>
>从服务器上删除一份文档
>>
>是否包含主体:否


* **状态码**

可以通过三维数字代码对不同的状态码进行分类

>* 整体范围  已定义范围  分类

>>
1. 100~199  100~101 信息提示
2. 200~299  200~206 成功
3. 300~399  300~305 重定向
4. 400~499  400~415 客户端错误
5. 500~599  500~505 服务器错误

* **版本号**

版本号会议HTTP/x.y的形式出现在请求和响应报文的起始行中。

版本号的目的是为使用HTTP的应用程序提供一种线索，以便互相了解对方的能力和报文格式。

版本号中的每个数字会被当做一个单独的数字来处理。在比较HTTP版本时，每个数字都必须单独进行比较，以便确定哪个版本更高。

## 状态码


### 100~199 信息性状态码

客户端应该不会收到100 Continue的响应

### 200~299 成功状态码

> 200 OK
>>
>请求没有问题，实体的主体部分包含了所有请求的资源

>201 Created
>>
>用于创建服务器对象的请求.

>202 Accepted
>>
>请求已被接受,但服务器还未对其执行任何动作.不能保证服务器会完成这个请求;这只是意味着接受请求时,它看起来是有效的.

>203 Non-Authoritative Infomation
>>
>实体首部包含的信息不是来自于源端服务器,而是来自资源的一份副本.乳沟中间节点上有一份资源副本.但无法或者没有对它所发送的与资源有关的元信息(首部)进行验证,就会出现这种情况.

>204 No Content 
>>
>响应报文中包含若干首部和一个状态行,但没有实体的主体部分.主要用于在浏览器不转为显示新文档的情况

>205 Reset Content
>>
>另一个主要用于浏览器的大夫.负责告诉浏览器清除当前页面中的所有HTML表单元素

>206 Partial Content
>>
>成功执行了一部分或Range(范围)请求.
>>
>206响应中必须包含Content-Range、Date以及ETag或Content-Location首部


### 300~399 重定向状态码

If-Modified-Since ，说明只读取对应时间之后修改过的文档。这个日期之后，此文档并未被修改过，因此服务器回送了一个304状态码，而不是文档的内容


>300 Mutiple Choices 
>>
>客户端请求一个实际指向多个资源的URL时会返回这个状态码,比如服务器上有某个HTML文档的英语和发育版本.返回这个代码时会带有一个选项列表;这样用户就可以选择他希望使用的那一项了.

>301 Moved Permanently 
>>在请求的URL已被移除时使用.相应的Location首部中应该包含资源现在所处的URL

>302 Found 
>>与301状态码类似;但是.客户端应该使用Location部首给出的URL来临时定位资源.将来的请求仍应使用老的URL

>303 See Other
>>告知客户端应该用另一个URL来获取资源.新的URL位于响应报文的Location首部.其主要目的是允许POST请求的响应将客户端定向到某个资源上去

>304 Not Modified 
>>客户端可以通过所包含的请求首部,使其请求标称有条件的.如果客户端发起了一个条件GET请求,而最近资源未被修改的话,就可以用这个状态码来说明资源没被修改.带有这个状态码的响应不应该包含实体的主体部分.

>305 Use Proxy
>>用来说明 必须通过一个代理来访问资源;代理的位置由Location首部给出.很重要的一点是,客户端是相对某个特定资源来解析来相应的,不能假定多有请求,甚至所有对持有所有请求资源的服务器的请求都通过这个代理进行.如果客户端错误地让代理介入了某条请求,可能会引发破坏性的行为,而且会造成安全漏洞

>307 Temporary Redirect
>>与301状态码类似；客户端应该使用Location部首给出的URL来临时定位资源.将来的请求仍应使用老的URL

302、303和307状态码之间存在一些交叉。这些状态吗的用法有着细微的差别，大部分差别都来源于HTTP/1.0和HTTP/1.1应用程序对这些状态码处理的方式不同。

HTTP/1.0使用302重定向post请求，并返回一个get重定向请求

HTTP/1.1使用303重定向post请求，并返回一个get重定向请求

为了避开这个问题，HTTP/1.1规范指出，对于HTTP/1.1客户端，用307状态码取代302状态码来进行临时重定向。这样服务器就可以将302状态码保留起来，为HTTP/1.0客户端使用了。


### 400~499 客户端错误状态码

>400 Bad Request
>>用于告知客户端他发送了一个错误的请求

>401 Unauthorized
>>与适当的首部一同返回,在这些首部,中请求客户端在获取对资源的访问权之前,对自己进行认证.

>402 Payment Required
>>未使用,保留,

>403 Forbidden
>>说明请求被服务器拒绝了.

>404 Not Found
>>用于说明服务器无法找到所请求的URL.通常会包含一个实体,以便客户端应用程序显示给用户看


>405 Method Not Allowed 
>>发起的请求中带有所请求的URL不支持的方法时,使用此状态码.应该在响应中包含Allow首部,已告知客户端所请求的资源可以使用哪些方法.

>406 Not Acceptable
>>客户端可以指定参数来说明他们愿意接收什么类型的实体,服务器没有与客服端可接受的URL相匹配的资源时,使用此代码.通常服务器会包含一些首部,以便客户端弄清楚为什么请求无法满足.

>407 Proxy Authentication Required  
>> 与401状态类似,但用于要求对资源进行认证的代理服务器

>408 Request Timeout
>>如果客户端完成请求所花的时间太长,服务器可以回送此状态码,并关闭连接.

>409 Conflict 
>>用于说明请求可能在资源上引发的一些冲突.服务器担心请求会引发冲突时,可以发送此状态码.响应中应包含描述冲入的主体

>410 Gone 
>>与404类似,只是服务器曾经拥有过此资源.主要用于Web站点的维护,这样服务器的管理者就可以在资源被移除情况下通知客服端了

>411 Length Required
>>服务器要求请求报文中包含Content-Length首部时使用.

>412 Precondition Failed
>>客户端发起了条件请求,且其中一个条件失败了的时候使用.客户端包含了Expect首部时发起的就是条件请求.

>413 Request Entity Too Large 
>>客户端发送的实体主体部分比服务器能够活着希望处理的要大时,使用此状态码

>414 Request URI Too Long
>>客户端所发送请求中的请求URL比服务器能够活着希望处理的要长时,使用此状态码

>415 Unsupported Media Type 
>> 服务器无法理解或无法支持客户端所发实体的内容类型时,使用此状态码

>416 Requested Range Not Satisfiable
>>请求报文请求的是指定资源的某个范围,而此范围无效或无法满足时,使用此状态码

>417 Expectation Failed
>>请求的Expect请求首部包含了一个期望,但服务器无法满足此期望时,使用此状态码.

### 500~599 服务器错误状态码



| 状态码     | 原因短语          | 含义  |
| ------------- |:-------------:| -----|
| 500     | Internal Server Error | 服务器遇到一个妨碍它为请求提供服务的错误时，使用此状态码 |
| 501| Not Implemented| 客户端发起的请求超出服务器的能力范围 |
| 502 |Bad Gateway|作为代理或网关使用的服务器从请求响应链的吓一跳连路上收到一条伪响应时，使用此状态码|
|503|Service Unavailable| 用来说明服务器现在无法伪请求提供服务，但将来可以。如果服务器知道什么时候资源会变为可用的，可以在响应中包含一个Retry-After首部。|
|504|Gateway Timeout|与状态码408类似，知识这里的响应来自一个网关或代理，他们等待另一个服务器对其请求进行响应时超时了|
|505|HTTP Version Not Supported|服务器收到的请求使用了它无法或不愿支持的版本协议，使用此状态码。有些服务器应用程序会选择不支持协议的早期版本。|



## 首部




