# 第二章 URL与资源


## URL的语法


### 通用URL语法格式

	<scheme>://<user>:<password>@<host>:<post>/<path>;<params>?<query>#<frag>


* **方案** 访问服务器以获取资源时要使用那种协议    （默认值：无）

* **用户** 某些方案访问资源是需要的用户名 （默认值：匿名）

* **密码** 用户名后面可能要包含的密码，中间用冒号(:)分隔（默认值：E-mail地址）

* **主机** 资源宿主服务器的主机名或点分IP地址(默认值:无)

* **端口** 资源宿主服务器正在监听的端口号，很多方案都有默认端口号(HTTP的默认端口号为80) (默认值:每个方案特有) 

* **路径** 服务器上资源的本地名，有一个斜杠(/)将其与前面的URL组件分隔开。路径组件的语法是与服务器和方案有关的(默认值:无)

* **参数** 某些方案会用这个组件来制定输入参数。参数为名/值对。URL中可以包含多个参数字段，他们相互之间以及与路径的其余部分之间用分号(;)分隔。

* **查询** 某些方案会用这个组件传递参数以激活应用程序(比如数据库、公告板。搜索引擎以及其他因特网网关)。查询组建的内容没有通用格式。用字符“?”将其与URL的其余部分分割开来(默认值:无)

* **片段** 一小片或一部分资源的名字。引用对象时，不会讲frag字段传送给服务器；这个字段是在客服端内部使用。通过字符"#"将其与URL的其余部分分隔开。


###方案

方案组件必须以一个字母符号开始，由第一个":"符号将其与URL的其余部分分隔开来。方案名是大小写无关的，因此"http"和"HTTP"是等价的。


###主机与端口
与之前相同

###用户名和密码

很多服务器都要求输入用户名和密码才会允许用户访问数据。FTP服务器就是这样的一个常见的事例。这里有几个例子

	ftp://ftp.prep.ai.mit.edu/pub/gnu
	ftp://anonymous@ftp.prep.ai.mit.edu/pub/gnu
	ftp://anonymous:my_passwd@ftp.prep.ai.mit.edu/pub/gnu
	http://joe:joespassod@www.joes-hardware.com/sales_info.txt

第一个例子没有用户名或密码组件，FTP通常会插入一个默认的用户名和密码。他救护插入anonymous(匿名用户)作为你的额用户名，并发送一个默认的密码

第二个例子显示的指定了anonymous的用户名。字符"@"将用户和密码组件与URL的奇遇部分分割开。

第三个例子中，指定了用户名和密码，两者之间由字符":"分隔。

###路径

###参数

例子

	ftp://prep.ai.mit.edu/pub/gnu;type=d

例子中，有一个参数type=d，参数名为type，值为d。
HTTP URL的路径组件可以分成若干路径段。每段都可以有自己的参数。

###查询字符串

### 片段（URL hash）

为了支持部分资源或资源的一个片段，URL支持使用片段（frag）组件来表示一个资源内部的片段。比如URL可以指向HTML文档中一个特定的图片或小节。

片段过载URL的右手边，最前面有一个字符"#"。比如

	http://www.joes-hardware.com/tools.html#drills


HTML文档里，浏览器会寻找那么属性为drills的<a\>标签，找到后滚动页面到该位置进行展示

* hash不会随HTTP请求发送 
* 跟在第一个#后的是hash标识符  颜色值16进制#fff会被解析失败
* 修改hash值不会重新加载页面但会增加一条浏览器历史记录。
* JavaScript可以通过window.location.hash修改URL hash
* 谷歌爬虫默认忽略hash标识

##各种令人头疼的字符

设计URL，使其可以通过任意因特网络协议安全地传输是很重要的。

安全传输意味着URL的传输不能丢失信息。为了避免这些问题，URL只是用一些相对较小的、通用的安全字母表中的字符

设计者希望URL是可读的，因此，及时不可见、不可打印的字符也不能在URL中使用。

URL还应该是完整的。

###URL字符集
很多应用程序使用的都是US-ASCII字符集。US-ASCII使用7位二进制码来表示英文打字机提供的大多数按键和少数用于文本格式和硬件通知的不可打印控制字符。

URL设计者就将转义序列集成了进去。通过转义序列，就可以用US-ASCII字符集的有限子集对任意字符值或数据进行编码了，这样就实现了可移植性和完整性。

### 编码机制

通过一种"转义"表示法表示不安全字符的，这种转移表示法包含一个百分号(%)，后面跟着两个表示字符ASCII码的十六进制数

	//例子
	~ 126(0X7E) http://www.joes-hardware.com/%7Ejoe


###字符限制

URL中有几个字符被保留起来，有着特殊的含义。有些字符不在定义的US-ASCII可打印字符集中。还有些字符会与某些因特网网关和协议产生混淆，因此不赞成使用。

* % 保留作为编码字符的转义标志
* / 保留作为路径组建中分隔路径短的定界符
* . 保留在路径组建中使用
* .. 保留在路径组建中使用
* # 保留作为分段定界符使用
* ？ 保留作为查询字符串定界符使用
* ； 保留作为参数定界符使用
* ： 保留作为方案、用户/口令，以及主机/端口组件的定界符使用
* $,+ 保留
* @ & = 在某些方案的上下文中有特殊的含义，保留
* { } | \ ^ ~ [ ] ` 由于各种传输Agent代理，比如各种网管的不安全处理，使用受限
* < > " 不安全；这些字符在URL范围之外通常是有意义的。 
* 0x00-0x1F,0x7F 受限， 不可打印区间
* >0x7F 受限，不在US-ASCII字符集的7二进制位范围内



###常见的方案几个事


>http
>> 超文本传输协议方案，出了没有用户名和密码之外，与通用的URL格式相符。如果省略了端口，就默认为80

>>基本格式:http://<host\>:<port\>/<path\>?<query\>#<frag\>

>https 
>>方案https与方案http是一对。唯一的区别在于方案https使用了王建的SSL，SSL为HTTP连接提供了端到端的加密机制。其语法与HTTP的语法相同，默认端口为443。

>>基本格式:https://<host\>:<port\>/<path\>?<query\>#<frag\>

>mailto
>> Mailto URL只想得失E-mail地址。mailto URL的格式与表尊URL的格式也有所不同。因特网E-mail地址的语法记录在RFC 822中

>>mailto:<RFC-822-addr-spec>


>ftp
>>文件传输协议。在Web和URL出现之前FTP就已经存在了。Web应用程序将FTP作为一种数据访问方案使用。URL语法遵循下列通用格式。

>>基本格式：ftp://<user\>:<password\>@<host>:<port\>/<path\>;<params\>

>rtsp,rtspu
>>RTSP URL是可以通过实时流传输协议解析的音/视频媒体资源的标识符

>>基本格式：
>rtsp://<user\>:<password\>@<host\>:<port\>/<path\>
>rtspu://<user\>:<password\>@<host\>:<port\>/<path\>

>file
>>方案file表示一台指定主机上可以直接访问的文件。个字段遵循通用格式。如果省略了主机名，就默认为正在使用URL的本地主机。

>>基本格式: file://<host\><path\>

>telnet
>>方案telnet用于访问交互式业务。它表示的并不是对象自身，而是可通过telnet协议访问的交互式应用程序

>>基本格式:telnet://<user\>:<password\>@<host\>:<port\>/












